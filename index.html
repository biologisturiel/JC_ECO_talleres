<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Taller: Análisis de Datos Biológicos en R</title>
    <meta charset="utf-8" />
    <meta name="author" content="Uriel Torres Zevallos" />
    <meta name="date" content="2021-04-14" />
    <script src="libs/header-attrs-2.7/header-attrs.js"></script>
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/default-fonts.css" rel="stylesheet" />
    <script src="libs/kePrint-0.0.1/kePrint.js"></script>
    <link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Taller: Análisis de Datos Biológicos en R
### Uriel Torres Zevallos
### Museo de Historia Natural, URP
### Laboratorio de Parasitología, URP
### 2021-04-14

---





class: inverse, middle, center
# Hola, hoy nos adentraremos en el mundillo de R

---


## Empecemos...¿Qué rayos es R?


![](images/diagrama_2.jpeg)
- R es considerado como un dialecto del lenguaje S 

- R fue creado por Ross Ihaka &amp; Robert Gentleman

- Lenguaje de Programación Orientada a Objetos (POO)

- Si el objeto ya existe, su valor es borrado y reemplazado

- Operador asignación ( &lt;- ) 

- Uso relativamente intuitivo

---

## Comunidad Comprometida

[![](images/logo stack.png)](https://stackoverflow.com/) [![](images/cross_imagen.png)](https://stats.stackexchange.com/)
[![](images/ecology_in_r.png)](https://www.facebook.com/groups/ecologyinr)

---

## Paquetes 

```r
# 20 de marzo a las 01:29 A.M.
nrow(available.packages())
```

```
## [1] 17418
```

&lt;img src="index_files/figure-html/unnamed-chunk-3-1.png" style="display: block; margin: auto;" /&gt;

[Todos los Paquetes de R](https://www.rdocumentation.org/)

---

## El paquete que te soluciona la vida: **Tidyverse**
[Libro: R for Data Science (**Wickham** &amp; Grolemund, 2017)](https://r4ds.had.co.nz/)

&lt;p&gt; &lt;/p&gt;
&lt;center&gt;
&lt;img src="images/tidyverse.png" height="450px" width="600px" class="center"/&gt;
&lt;/center&gt;

---
 
## ¿Por qué debo usar R, y no SPSS, Infostat, Past, STATA...?

- Potencial en visualización de datos (gráficos de alto impacto)

- Potencial en uso estadístico  (Frecuentista &amp; Bayesiano)

- R resume los resultados en una línea

- R es compatible con todo (código libre y abierto)

- Comunidad comprometida

- Conexión con otros software (\Latex, Python, Julia, QGIS, MaxEnt)

- R hace de todo


---

class: center, middle, inverse
# Objetivo: Recordar conceptos estadísticos e introducción al análisis de datos en R

---

# Teoría y creación de objetos de R

R trabaja con objetos (POO), y **todos** tienen...
- **Nombre**: debe comenzar con una letra (A- Z o a-z), puede incluir letras, dígitos (0-9), y puntos (.). R discrimina entre mayúsculas y minúsculas (X y x).


```r
abundancia &lt;- c(12, 12, 11, 10, 8, 23)
playas &lt;- c("San Bartolo", "Pucusana", "Chancaíllo", "Santa Rosa", "Costa Azul", "Lurín")
```

--

- **Contenido**: Numérico o Caracteres


```r
abundancia
```

```
## [1] 12 12 11 10  8 23
```

```r
playas
```

```
## [1] "San Bartolo" "Pucusana"    "Chancaíllo"  "Santa Rosa"  "Costa Azul" 
## [6] "Lurín"
```

---
- **Dimensión** o **longitud**


```r
length(abundancia)
```

```
## [1] 6
```

```r
length(playas)
```

```
## [1] 6
```


```r
base_datos &lt;- data.frame(
                        Alumnos = c("Yessica", "Juan", "Uriel"),
                        Nota = c(20, 17, 11)
                        )
base_datos
```

```
##   Alumnos Nota
## 1 Yessica   20
## 2    Juan   17
## 3   Uriel   11
```

```r
dim(base_datos)
```

```
## [1] 3 2
```


---

# Estructura de datos (**clases**) en R
![](images/estrutura_datos.jpeg)
---

## Vector


```r
Playas &lt;- c("San Bartolo", "Pucusana", "Chancaíllo", "Santa Rosa", "Costa Azul", "Lurín")
class(Playas)
```

```
## [1] "character"
```

```r
Nivel_contaminacion &lt;- c("Saludable", "No Saludable", "Poco Saludable", "Saludable", "No Saludable", "No Saludable")
class(Nivel_contaminacion)
```

```
## [1] "character"
```

```r
Presencia_garza &lt;- c(T, F, T, T, F, T)
class(Presencia_garza)
```

```
## [1] "logical"
```

```r
Abundancia_garza &lt;- c(12, 23, 10, 5, 10, 12)
class(Abundancia_garza)
```

```
## [1] "numeric"
```

---

## Data Frame

```r
data &lt;- data.frame(Playas, Nivel_contaminacion, Presencia_garza, Abundancia_garza)

data
```

```
##        Playas Nivel_contaminacion Presencia_garza Abundancia_garza
## 1 San Bartolo           Saludable            TRUE               12
## 2    Pucusana        No Saludable           FALSE               23
## 3  Chancaíllo      Poco Saludable            TRUE               10
## 4  Santa Rosa           Saludable            TRUE                5
## 5  Costa Azul        No Saludable           FALSE               10
## 6       Lurín        No Saludable            TRUE               12
```

```r
dim(data)
```

```
## [1] 6 4
```

```r
class(data)
```

```
## [1] "data.frame"
```

---
### Indexación

```r
data[1, 2]
```

```
## [1] "Saludable"
```

```r
data[3, 1]
```

```
## [1] "Chancaíllo"
```

```r
data[3, c(1,2,3,4)]
```

```
##       Playas Nivel_contaminacion Presencia_garza Abundancia_garza
## 3 Chancaíllo      Poco Saludable            TRUE               10
```

```r
data[3, 1:4]
```

```
##       Playas Nivel_contaminacion Presencia_garza Abundancia_garza
## 3 Chancaíllo      Poco Saludable            TRUE               10
```

---
### Indexación con DataEditR

```r
library(DataEditR)
# DataEditR::data_edit(data)
```
![](images/baby_yoda.gif)

---

## Listas

```r
lista_a &lt;- list(Playas, Nivel_contaminacion, data)
lista_a[[1]]
```

```
## [1] "San Bartolo" "Pucusana"    "Chancaíllo"  "Santa Rosa"  "Costa Azul" 
## [6] "Lurín"
```

```r
lista_a[[2]]
```

```
## [1] "Saludable"      "No Saludable"   "Poco Saludable" "Saludable"     
## [5] "No Saludable"   "No Saludable"
```

```r
lista_a[[3]]
```

```
##        Playas Nivel_contaminacion Presencia_garza Abundancia_garza
## 1 San Bartolo           Saludable            TRUE               12
## 2    Pucusana        No Saludable           FALSE               23
## 3  Chancaíllo      Poco Saludable            TRUE               10
## 4  Santa Rosa           Saludable            TRUE                5
## 5  Costa Azul        No Saludable           FALSE               10
## 6       Lurín        No Saludable            TRUE               12
```

---


```r
lista_b &lt;- list("Hola", Playas, "Colores") 
lista_b
```

```
## [[1]]
## [1] "Hola"
## 
## [[2]]
## [1] "San Bartolo" "Pucusana"    "Chancaíllo"  "Santa Rosa"  "Costa Azul" 
## [6] "Lurín"      
## 
## [[3]]
## [1] "Colores"
```

---

# Bases de datos
## Tidy data [(Wickham, 2014)](https://vita.had.co.nz/papers/tidy-data.pdf)

 - Estructura adecuada de la base de datos
 
 - Variable -&gt; columna
 
 - Observación -&gt; fila 

![](images/tidy_data.png)

---


# ¿Será tidy?

```r
df1 &lt;- data.frame(
                 nombres = c("Hormiga A", "Hormiga B", "Hormiga C", "Hormiga D"),
                 Pantanos_Villa = c(12, 22, 9, 10), 
                 Ventanilla = c(0, 7, 6, 1)
                 )
```

&lt;table class=" lightable-paper lightable-striped table" style='font-family: "Arial Narrow", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto; font-size: 13px; margin-left: auto; margin-right: auto;'&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; nombres &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Pantanos_Villa &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Ventanilla &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Hormiga A &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 12 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Hormiga B &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 22 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Hormiga C &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Hormiga D &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 10 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---
# ¿Será tidy?

```r
df2 &lt;- data.frame(
                  localidad = c("Pantanos de Villa, Ventanilla", "Pantanos de Villa, Ventanilla" ),
                  Hormiga_A = c(12, 0), 
                  Hormiga_B = c(22, 7), 
                  Hormiga_C = c(9, 6), 
                  Hormiga_D = c(10, 1)
                 )
```


&lt;table class=" lightable-paper lightable-striped table" style='font-family: "Arial Narrow", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto; font-size: 13px; margin-left: auto; margin-right: auto;'&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; localidad &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Hormiga_A &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Hormiga_B &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Hormiga_C &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Hormiga_D &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Pantanos de Villa, Ventanilla &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 12 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 22 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 10 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Pantanos de Villa, Ventanilla &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---
# ¿Será tidy? 



```r
df3 &lt;-  data.frame(
                  especie = c("Hormiga A", "Hormiga B", "Hormiga C", "Hormiga D", "Hormiga A", "Hormiga B", "Hormiga C", "Hormiga D"), 
                  localidad = c("Pantanos de Villa", 'Pantanos de Villa', "Pantanos de Villa", "Pantanos de Villa", "Ventanilla", 'Ventanilla', "Ventanilla", "Ventanilla"), 
                  abundancia = c(12, 22, 9, 10, 0, 7, 6, 1)
                  )
```

&lt;table class=" lightable-paper lightable-striped table" style='font-family: "Arial Narrow", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto; font-size: 13px; margin-left: auto; margin-right: auto;'&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; especie &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; localidad &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; abundancia &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Hormiga A &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Pantanos de Villa &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 12 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Hormiga B &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Pantanos de Villa &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 22 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Hormiga C &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Pantanos de Villa &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Hormiga D &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Pantanos de Villa &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 10 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Hormiga A &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Ventanilla &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Hormiga B &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Ventanilla &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Hormiga C &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Ventanilla &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Hormiga D &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Ventanilla &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---

class: inverse, middle, center
# Importar base de datos

---

## Importar en formato **CSV** (comma-separated values)

```r
df &lt;- read.csv("/home/biologisturiel/Descargas/talleres_en_R/github_talleres/data/data_emerita.csv")
```


```r
head(df)
```

```
##   ID       NMP      EST FC                  LC DIST LCT    SEX NTP RP P_altmani
## 1  1 Saludable Invierno  0 Santa María del Mar    0 2.0  Macho   0  0         0
## 2  2 Saludable Invierno  0 Santa María del Mar    5 2.1  Macho   1  1         1
## 3  3 Saludable Invierno  0 Santa María del Mar    5 3.2 Hembra   2  1         2
## 4  4 Saludable Invierno  0 Santa María del Mar   10 1.7  Macho   0  0         0
## 5  5 Saludable Invierno  0 Santa María del Mar   10 1.7  Macho   0  0         0
## 6  6 Saludable Invierno  0 Santa María del Mar   10 1.6  Macho   0  0         0
##   Proleptus_sp.
## 1             0
## 2             0
## 3             0
## 4             0
## 5             0
## 6             0
```

---


```r
head(df, 10)
```

```
##    ID       NMP      EST FC                  LC DIST LCT    SEX NTP RP
## 1   1 Saludable Invierno  0 Santa María del Mar    0 2.0  Macho   0  0
## 2   2 Saludable Invierno  0 Santa María del Mar    5 2.1  Macho   1  1
## 3   3 Saludable Invierno  0 Santa María del Mar    5 3.2 Hembra   2  1
## 4   4 Saludable Invierno  0 Santa María del Mar   10 1.7  Macho   0  0
## 5   5 Saludable Invierno  0 Santa María del Mar   10 1.7  Macho   0  0
## 6   6 Saludable Invierno  0 Santa María del Mar   10 1.6  Macho   0  0
## 7   7 Saludable Invierno  0 Santa María del Mar   10 3.4 Hembra   1  1
## 8   8 Saludable Invierno  0 Santa María del Mar   10 2.2  Macho   0  0
## 9   9 Saludable Invierno  0 Santa María del Mar   10 2.2  Macho   0  0
## 10 10 Saludable Invierno  0 Santa María del Mar   10 2.2  Macho   0  0
##    P_altmani Proleptus_sp.
## 1          0             0
## 2          1             0
## 3          2             0
## 4          0             0
## 5          0             0
## 6          0             0
## 7          1             0
## 8          0             0
## 9          0             0
## 10         0             0
```

---


```r
tail(df)
```

```
##        ID       NMP   EST FC      LC DIST LCT    SEX NTP RP P_altmani
## 3620 3620 Saludable Otoño  8 Venecia   NA 2.7 Hembra   3  1         0
## 3621 3621 Saludable Otoño  8 Venecia   NA 2.6 Hembra   5  1         5
## 3622 3622 Saludable Otoño  8 Venecia   NA 1.5 Hembra   8  2         2
## 3623 3623 Saludable Otoño  8 Venecia   NA 2.0  Macho   5  2         3
## 3624 3624 Saludable Otoño  8 Venecia   NA 2.3 Hembra   7  2         2
## 3625 3625 Saludable Otoño  8 Venecia   NA 2.1 Hembra   0  0         0
##      Proleptus_sp.
## 3620             3
## 3621             0
## 3622             6
## 3623             2
## 3624             5
## 3625             0
```

---


```r
tail(df, 9)
```

```
##        ID       NMP   EST FC      LC DIST LCT    SEX NTP RP P_altmani
## 3617 3617 Saludable Otoño  8 Venecia   NA 2.2 Hembra   8  2         5
## 3618 3618 Saludable Otoño  8 Venecia   NA 2.8  Macho   2  1         0
## 3619 3619 Saludable Otoño  8 Venecia   NA 2.4 Hembra   4  2         2
## 3620 3620 Saludable Otoño  8 Venecia   NA 2.7 Hembra   3  1         0
## 3621 3621 Saludable Otoño  8 Venecia   NA 2.6 Hembra   5  1         5
## 3622 3622 Saludable Otoño  8 Venecia   NA 1.5 Hembra   8  2         2
## 3623 3623 Saludable Otoño  8 Venecia   NA 2.0  Macho   5  2         3
## 3624 3624 Saludable Otoño  8 Venecia   NA 2.3 Hembra   7  2         2
## 3625 3625 Saludable Otoño  8 Venecia   NA 2.1 Hembra   0  0         0
##      Proleptus_sp.
## 3617             3
## 3618             2
## 3619             2
## 3620             3
## 3621             0
## 3622             6
## 3623             2
## 3624             5
## 3625             0
```

---

## Otros casos
## Excel

```r
df_excel &lt;- read_excel('aca debe ir la dirección en donde se encuentra tu archivo, tu archivo debe acabar en xls o xlsx')
```

## Importar archivos de más de 3GB (muy pesados)

```r
library(data.table)
df_pesada &lt;- fread("/home/biologisturiel/Descargas/talleres_en_R/github_talleres/data/data_emerita.csv")
```

---

### ¿fread o read.csv?

```r
system.time(fread("/home/biologisturiel/Descargas/talleres_en_R/github_talleres/data/data_emerita.csv"))
```

```
##    user  system elapsed 
##   0.003   0.000   0.002
```


```r
system.time(read.csv("/home/biologisturiel/Descargas/talleres_en_R/github_talleres/data/data_emerita.csv"))
```

```
##    user  system elapsed 
##   0.013   0.000   0.013
```

---

## Importar archivos delimitados por espacios (por ejem GBIF)

```r
df_gbif &lt;- fread("/home/biologisturiel/Descargas/talleres_en_R/github_talleres/data/occurrence.txt")
```

## Importar ignorando ubicación del archivo

```r
df_aelegir &lt;- fread(file.choose()) 
```

---
# Distribución y teoría de la probabilidad
- Los datos de ecología casi nunca  se adecúan a una distribución normal

- Los datos de ecología se pueden transformar pero la conclusión sería en función de los datos transformados

- Datos en ecología: Usan distribución de Poisson (recuentos) o Binomial (presencia o ausencia)

---
## Distribución normal 
![](index_files/figure-html/unnamed-chunk-33-1.png)&lt;!-- --&gt;

---

## Distribución de Poisson (recuentos)
![](index_files/figure-html/unnamed-chunk-34-1.png)&lt;!-- --&gt;

---

## Distribución Binomial (presencia o ausencia)
![](index_files/figure-html/unnamed-chunk-35-1.png)&lt;!-- --&gt;

---

## Distribución de una especie (SDM: Species Distribution Model)
![](index_files/figure-html/unnamed-chunk-36-1.png)&lt;!-- --&gt;

---
## Distribución de una especie (SDM: Species Distribution Model)
![](index_files/figure-html/unnamed-chunk-37-1.png)&lt;!-- --&gt;

---

class: center, inverse, middle
# Estadísticos descriptivos 

---

## Estadísticos de tendencia central

--

### Media (promedio)
$$
\overline x=\frac{\sum x}{n}
$$


```r
mean(df$LCT)
```

```
## [1] 1.605
```

### Mediana

$$
Mediana  = \frac{(n + 1)}{2}
$$

```r
median(df$LCT)
```

```
## [1] 1.5
```

---

### Moda

- El valor de mayor frecuencia absoluta 


```r
frecuencias &lt;- table(df$LCT)
frecuencias_df &lt;- as.data.frame(frecuencias)
which.max(frecuencias_df$Freq)
```

```
## [1] 56
```

```r
frecuencias_df[56, ]
```

```
##    Var1 Freq
## 56  1.5  378
```

---

## Estadísticos de dispersión

--

### Varianza (incluir unidad de medida)
$$
s^{2} = \sqrt \frac{\sum(x_{i} - \overline x)^{2}}{n}
$$

```r
var(df$LCT)
```

```
## [1] 0.3785787
```

### **Desviación estándar (DE o SD) (incluir unidad de medida)**
$$
s = \sqrt \frac{\sum(x_{i} - \overline x)^{2}}{n}
$$

```r
sd(df$LCT)
```

```
## [1] 0.6152875
```

---

### Coeficiente de variación (adimensional)
$$
CV = \frac{s}{\overline x}*100
$$

```r
sd(df$LCT)/mean(df$LCT)*100
```

```
## [1] 38.33567
```

### **Error estándar (EE or SE) (incluir unidad de medida)**
$$
SE = \frac{s}{\sqrt{n}}
$$

```r
sd(df$LCT)/sqrt(nrow(df))
```

```
## [1] 0.01021937
```
### [**¿SD o SE?**](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1255808/#:~:text=The%20standard%20deviation%20(often%20SD%20is%20a%20measure%20of%20variability.&amp;text=We%20can%20estimate%20how%20much,standard%20deviation%2C%20confusion%20is%20understandable)

---

## Tidyverse en obtención de estadísticos
### [Data de aplicación](https://www.researchgate.net/publication/330900496_IMPLICATIONS_OF_THE_SANITARY_QUALITY_OF_BEACHES_IN_THE_PARASITIC_ECOLOGY_OF_EMERITA_ANALOGA_STIMPSON_1857_DECAPODA_HIPPIDAE)


```r
glimpse(df)
```

```
## Rows: 3,625
## Columns: 12
## $ ID            &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 1…
## $ NMP           &lt;chr&gt; "Saludable", "Saludable", "Saludable", "Saludable", "Sal…
## $ EST           &lt;chr&gt; "Invierno", "Invierno", "Invierno", "Invierno", "Inviern…
## $ FC            &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
## $ LC            &lt;chr&gt; "Santa María del Mar", "Santa María del Mar", "Santa Mar…
## $ DIST          &lt;int&gt; 0, 5, 5, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 15, 15,…
## $ LCT           &lt;dbl&gt; 2.0, 2.1, 3.2, 1.7, 1.7, 1.6, 3.4, 2.2, 2.2, 2.2, 1.6, 2…
## $ SEX           &lt;chr&gt; "Macho", "Macho", "Hembra", "Macho", "Macho", "Macho", "…
## $ NTP           &lt;int&gt; 0, 1, 2, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1,…
## $ RP            &lt;int&gt; 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1,…
## $ P_altmani     &lt;int&gt; 0, 1, 2, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1,…
## $ Proleptus_sp. &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
```

---
### Playa de estudio

```r
unique(df$LC)
```

```
##  [1] "Santa María del Mar" "Los Viños"           "Venecia"            
##  [4] "Hermosa"             "San Pedro"           "Los Delfines"       
##  [7] "Conchán"             "El Silencio"         "Chica"              
## [10] "Costa Azul"          "Los Yuyos"           "Agua Dulce"         
## [13] "Pucusana"
```

---
### Promedio de LCT por playa de estudio

```r
df %&gt;% 
  group_by(LC) %&gt;% 
  summarise(promedio_playas_LCT = mean(LCT))
```

```
## # A tibble: 13 x 2
##    LC                  promedio_playas_LCT
##    &lt;chr&gt;                             &lt;dbl&gt;
##  1 Agua Dulce                         1.56
##  2 Chica                              2.26
##  3 Conchán                            2.23
##  4 Costa Azul                         2.43
##  5 El Silencio                        2.05
##  6 Hermosa                            2.07
##  7 Los Delfines                       1.42
##  8 Los Viños                          1.28
##  9 Los Yuyos                          2.12
## 10 Pucusana                           2.28
## 11 San Pedro                          1.68
## 12 Santa María del Mar                1.80
## 13 Venecia                            1.78
```

---
### SD de LCT por playa de estudio

```r
df %&gt;% 
  group_by(LC) %&gt;% 
  summarise(SD_playas_LCT = sd(LCT))
```

```
## # A tibble: 13 x 2
##    LC                  SD_playas_LCT
##    &lt;chr&gt;                       &lt;dbl&gt;
##  1 Agua Dulce                  0.396
##  2 Chica                       0.691
##  3 Conchán                     0.559
##  4 Costa Azul                  0.450
##  5 El Silencio                 0.818
##  6 Hermosa                     0.757
##  7 Los Delfines                0.641
##  8 Los Viños                   0.438
##  9 Los Yuyos                   0.624
## 10 Pucusana                    0.487
## 11 San Pedro                   0.654
## 12 Santa María del Mar         0.526
## 13 Venecia                     0.526
```

---
### SE de LCT por playa de estudio

```r
df %&gt;% 
  group_by(LC) %&gt;% 
  summarise(SE_playas_LCT = sd(LCT)/sqrt(nrow(df)))
```

```
## # A tibble: 13 x 2
##    LC                  SE_playas_LCT
##    &lt;chr&gt;                       &lt;dbl&gt;
##  1 Agua Dulce                0.00657
##  2 Chica                     0.0115 
##  3 Conchán                   0.00928
##  4 Costa Azul                0.00748
##  5 El Silencio               0.0136 
##  6 Hermosa                   0.0126 
##  7 Los Delfines              0.0106 
##  8 Los Viños                 0.00727
##  9 Los Yuyos                 0.0104 
## 10 Pucusana                  0.00808
## 11 San Pedro                 0.0109 
## 12 Santa María del Mar       0.00873
## 13 Venecia                   0.00874
```

---
### Recordando la interpretación de un boxplot 
![](index_files/figure-html/unnamed-chunk-50-1.png)&lt;!-- --&gt;

---
### ¿En qué playa los muy muys tienen mayor LCT?


```r
library(ggthemes)

# formato para realizar cualquier tipo de gráfico en ggplot2
ggplot(data = df, aes(x = LC, y = LCT)) + 
  
  # comando para ejecutar el boxplot 
  geom_boxplot() + 
  
  # tema del gráfico 
  theme_bw() + 
  
  # etiqueta para el eje x
  xlab("Playas") + 
  
  # etiqueta para el eje y
  ylab("Longitud del cefalotórax del muy muy") +
  
  # modificando la estructura del gráfico
  theme(axis.text.x = element_text(angle = 90))
```

---

### ¿En qué playa los muy muys tienen mayor LCT?
![](index_files/figure-html/unnamed-chunk-52-1.png)&lt;!-- --&gt;

---
### ¿Qué sexo tiene mayor LCT?

```r
# formato por defecto (fill = llenar "rellena con color en fx de var. independiente)
ggplot(data = df, aes(x = SEX, y = LCT, fill = SEX)) + 
  
  # comando para ejecutar un violin plot (show.legend = F, remueve leyenda)
  geom_violin(show.legend = F) +
  
  # tema para publicación (base_size = asigna tamaño de fuente)
  theme_tufte(base_size = 17) + 
  
  # genera ejes, ya que theme_tufte no genera tufte (X &amp; y)
  theme(axis.line = element_line()) +

  # arreglamos etiquetas
  xlab("Sexo") +
  ylab("Longitud del cefalotórax")
```

---

### ¿Qué sexo tiene mayor LCT?
![](index_files/figure-html/unnamed-chunk-54-1.png)&lt;!-- --&gt;

---

### ¿Cuál es la relación entre el tamaño del muy muy y la carga parasitaria? 

```r
 # formato convencional
ggplot(data = df, aes(x = P_altmani, y = LCT)) +
  
  # geom_point (alternativa = geom_jitter), alpha genera transparencia (0-1)
  # fill = relleno; color = bordes; shape = forma; size = tamaño
  geom_point(alpha = 0.5, fill  = "blue", color = "yellow", shape = 21, size = 2.7) +
  
  # genera una línea de tendencia 
  geom_smooth() + 
  
  # tema elegido (bw: black and white)
  theme_bw() +
  
  # asignar nombres a etiquetas
  xlab("Profilicollis altmani") +
  ylab("Longitud del cefalotórax")
```

---
### ¿Cuál es la relación entre el tamaño del muy muy y la carga parasitaria? 
![](index_files/figure-html/unnamed-chunk-56-1.png)&lt;!-- --&gt;

---

class: middle, inverse, center
# Inferencia estadística

---

### Tener consideración los NAs (not available) y outliers (datos atípicos)

```r
library(DataExplorer)
plot_missing(df)
```

![](index_files/figure-html/unnamed-chunk-57-1.png)&lt;!-- --&gt;

```r
dim(df)
```

```
## [1] 3625   12
```

---
### Eliminar NAs

```r
dim(df)
```

```
## [1] 3625   12
```

```r
df_sinNA &lt;- drop_na(df)
dim(df_sinNA)
```

```
## [1] 3374   12
```


```r
plot_missing(df_sinNA)
```

---
### Eliminar outliers **(solo cuando se elabora un modelo: LM, GLM; criterio)**

```r
# Criterio para establecer límites de valores atípicos 
# Rango intercuartílico: Q3 - Q1 
# Q3 + 1.5 * IQR 
# Q1 - 1.5 * IQR 

fivenum(df$NTP)
```

```
## [1]  0  0  1  3 26
```


```r
boxplot(df$NTP)
```

![](index_files/figure-html/unnamed-chunk-61-1.png)&lt;!-- --&gt;

### Eliminar outliers

```r
outliers &lt;- boxplot(df$NTP, plot = F)$out
outliers
```

```
##   [1] 11  8  8 10  8 12 12  8  8  9 14  8  9  8  8 13 13 13  8 11  9 11  8 19  8
##  [26]  9 17 17  8 14 11 13 10  8  9 19 22 12 10  9 11  9  9 15 11 11  8 16 26 22
##  [51] 11 12 15 11 13 12 14  8 10 20 11  8  9 10 11 13 12 10 12  8 12 12  9 12 13
##  [76] 14 13 14  8 11 11 15 14 14 15 10 12 10 15 10  9  9  8  8  8  9  9 11 12 11
## [101] 18 24  9 10 13 13 14 10  9  8  8 14 13 11 16 14  9 12 24 10 13 20 23  9 10
## [126] 10  9 19 10 17 14  9 12 11  8 10  9 25  9 11  9 17 10 14  8  8  8 17  9 10
## [151]  9 10 17 10 12 10  9 10  9 11  9  8  8 10 10  8  9  8 11 11  9  9  8 10  9
## [176]  8 10  8  9 11 15 16  8 10 13  8 13  8  8  8  9  8 10  9 12 10 11 16 12 10
## [201]  9  9  8  8  8  8  9  8 15  8 11 10  9  8  8  8  8  8
```

---
### Eliminar outliers

```r
df_sinoutliers &lt;- df[-which(df$NTP %in% outliers), ]
```


```r
boxplot(df_sinoutliers$NTP)
```

![](index_files/figure-html/unnamed-chunk-64-1.png)&lt;!-- --&gt;

---
## Pruebas paramétricas
Requisitos: 
- Normalidad de los datos (Prueba de Shapiro-Wilk &amp; Kolmogorov-Smirnov) 
`$$H_{0}: X \in Normal$$`
`$$H_{1}: X \notin Normal$$`
- Homocedasticidad (Prueba de Levene)
`$$H_{0}: s² = s²$$`
$$H_{1}: s² \neq s² $$

--

### Prueba de t de Student: 

`$$H_{0}: \overline x_{Playa 1} = \overline x_{Playa 2}$$`
`$$H_{1}: \overline x_{Playa 1} \neq \overline x_{Playa 2}$$`
---

### Prueba de t de Student (muestras relacionadas): 

`$$H_{0}: \overline x_{Playa 1} = \overline x_{Playa 2}$$`

`$$H_{1}: \overline x_{Playa 1} \neq \overline x_{Playa 2}$$`

### Prueba de ANOVA: 

`$$H_{0}: \overline x_{Playa 1} = \overline x_{Playa 2} = \overline x_{Playa 3}...$$`

`$$H_{1}: \overline x_{Playa 1} \neq \overline x_{Playa 2} = \overline x_{Playa 4}...$$`

### Correlación de Pearson: 
`$$H_{0}: p~value = 0$$`
`$$H_{1}: p~value \neq 0$$`
---

## Pruebas no paramétricas

Requisitos:
- No normalidad 

### Prueba de U de Mann-Whitney:
`$$H_{0}: \overline x_{Playa 1} = \overline x_{Playa 2}$$`
`$$H_{1}: \overline x_{Playa 1} = \overline x_{Playa 2}$$`


```r
wilcox.test(df$LCT ~ df$SEX, paired = F, alternative = "two.sided")
```

```
## 
## 	Wilcoxon rank sum test with continuity correction
## 
## data:  df$LCT by df$SEX
## W = 2004304, p-value &lt; 2.2e-16
## alternative hypothesis: true location shift is not equal to 0
```
---


```r
library(ggpubr)
ggplot(data = df, aes(x = SEX, y = LCT, fill = SEX)) +
  geom_violin(show.legend = F) +
  stat_compare_means(method = "wilcox.test", label.x = 1.35, label.y = 5) +
  theme_tufte(base_size = 12) +
  theme(axis.line = element_line()) + 
  scale_fill_gdocs()
```

![](index_files/figure-html/unnamed-chunk-66-1.png)&lt;!-- --&gt;

### Prueba de Wilcoxon no paramétrico:
`$$H_{0}: \overline x_{Playa 1} = \overline x_{Playa 2}$$`
`$$H_{1}: \overline x_{Playa 1} = \overline x_{Playa 2}$$`

---

### Prueba de Kruskal-Wallis:

`$$H_{0}: \overline x_{Playa 1} = \overline x_{Playa 2} = \overline x_{Playa 3}...$$`

`$$H_{1}: \overline x_{Playa 1} \neq \overline x_{Playa 2} = \overline x_{Playa 4}...$$`


```r
kruskal.test(df$NTP ~ df$LC)
```

```
## 
## 	Kruskal-Wallis rank sum test
## 
## data:  df$NTP by df$LC
## Kruskal-Wallis chi-squared = 421.73, df = 12, p-value &lt; 2.2e-16
```
---

### Prueba de Kruskal-Wallis:

```r
ggplot(data = df, aes(x = LC, y = NTP)) + 
  geom_boxplot()  + 
  stat_compare_means(method = "kruskal.test", label.x = 1.4, label.y = 44) + 
  stat_compare_means(method = "wilcox.test", comparison = list(c("Conchán", "Costa Azul"), c("Pucusana", "San Pedro"), c("Los Delfines", "Los Viños"), c("Conchán", "El Silencio"))) +
  theme_bw() + 
  theme(axis.text.x = element_text(angle = 90)) 
```

![](index_files/figure-html/unnamed-chunk-68-1.png)&lt;!-- --&gt;

---

### Correlación de Spearman: 

`$$H_{0}: p~value = 0$$`
`$$H_{1}: p~value \neq 0$$`


```r
cor.test(df$NTP, df$LCT, method = "spearman")
```

```
## 
## 	Spearman's rank correlation rho
## 
## data:  df$NTP and df$LCT
## S = 5389626527, p-value &lt; 2.2e-16
## alternative hypothesis: true rho is not equal to 0
## sample estimates:
##       rho 
## 0.3211311
```

---

### Seleccionamos variables de interés para la correlación

```r
df_select &lt;- df_sinNA %&gt;% select(DIST, LCT, NTP, RP, P_altmani, Proleptus_sp.)
head(df_select, 13)
```

```
##    DIST LCT NTP RP P_altmani Proleptus_sp.
## 1     0 2.0   0  0         0             0
## 2     5 2.1   1  1         1             0
## 3     5 3.2   2  1         2             0
## 4    10 1.7   0  0         0             0
## 5    10 1.7   0  0         0             0
## 6    10 1.6   0  0         0             0
## 7    10 3.4   1  1         1             0
## 8    10 2.2   0  0         0             0
## 9    10 2.2   0  0         0             0
## 10   10 2.2   0  0         0             0
## 11   10 1.6   0  0         0             0
## 12   10 2.1   0  0         0             0
## 13   10 1.6   0  0         0             0
```

---
### Hallamos coeficientes de Rho de Spearman

```r
library(corrplot)
coeficientes &lt;-  cor(df_select, method = "spearman")
coeficientes
```

```
##                       DIST        LCT         NTP          RP    P_altmani
## DIST           1.000000000 -0.2086281 -0.02985356 -0.01808187 -0.001529756
## LCT           -0.208628115  1.0000000  0.31287340  0.29371462  0.219602514
## NTP           -0.029853560  0.3128734  1.00000000  0.92096390  0.855599333
## RP            -0.018081867  0.2937146  0.92096390  1.00000000  0.784838842
## P_altmani     -0.001529756  0.2196025  0.85559933  0.78483884  1.000000000
## Proleptus_sp. -0.071339273  0.3183495  0.69729566  0.74769551  0.311775920
##               Proleptus_sp.
## DIST            -0.07133927
## LCT              0.31834950
## NTP              0.69729566
## RP               0.74769551
## P_altmani        0.31177592
## Proleptus_sp.    1.00000000
```

---

### Hallamos *p-value*


```r
pvalores &lt;- cor.mtest(df_select, method = "spearman", exact = F)$p
pvalores
```

```
##              [,1]         [,2]         [,3]         [,4]         [,5]
## [1,] 0.000000e+00 1.702187e-34 8.294967e-02 2.937169e-01 9.292212e-01
## [2,] 1.702187e-34 0.000000e+00 1.618535e-77 4.064584e-68 4.003479e-38
## [3,] 8.294967e-02 1.618535e-77 0.000000e+00 0.000000e+00 0.000000e+00
## [4,] 2.937169e-01 4.064584e-68 0.000000e+00 0.000000e+00 0.000000e+00
## [5,] 9.292212e-01 4.003479e-38 0.000000e+00 0.000000e+00 0.000000e+00
## [6,] 3.360187e-05 2.457931e-80 0.000000e+00 0.000000e+00 5.846041e-77
##              [,6]
## [1,] 3.360187e-05
## [2,] 2.457931e-80
## [3,] 0.000000e+00
## [4,] 0.000000e+00
## [5,] 5.846041e-77
## [6,] 0.000000e+00
```

--- 
---

## Diagrama de correlación de Spearman


```r
library(ggcorrplot)
ggcorrplot(coeficientes, p.mat = pvalores, type = "upper", hc.order = F, lab = T, insig = "blank") + 
  theme_bw() + 
  theme(axis.text.x = element_text(angle = 90)) +
  scale_fill_gradient2(name = "Correlación\nSpearman", low = "blue", high = "red", mid = "white", limit = c(-1, 1)) +
  xlab(NULL) + 
  ylab(NULL)
```

&lt;img src="index_files/figure-html/unnamed-chunk-73-1.png" style="display: block; margin: auto;" /&gt;

---

class: inverse, middle, center
# Fin

---
# Pero antes...
- example(): Un ejemplo de R sobre cualquier comando

- [**Swirl**](https://swirlstats.com/students.html): Paquete para aprender R &lt;3

- help(): Pedir ayuda en R (muestra info relacionada al comando)

- Stackoverflow: Comunidad comprometida

- Cheatsheet: [Basic](https://www.rstudio.com/wp-content/uploads/2016/10/r-cheat-sheet-3.pdf); [Dplyr](https://www.rstudio.com/wp-content/uploads/2015/02/data-wrangling-cheatsheet.pdf); [ggplot2](https://www.rstudio.com/wp-content/uploads/2015/03/ggplot2-cheatsheet.pdf)

---

class: inverse, middle, center
# Ahora sí, fin :) 













    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
